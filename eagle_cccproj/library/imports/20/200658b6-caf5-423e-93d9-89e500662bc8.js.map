{"version":3,"sources":["assets/Writing/Script/WritingChar.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,2CAAsC;AAEhC,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAA0B,CAAC;AAE5C,IAAM,aAAa,GAAG,GAAG,CAAC;AAE1B;;;;GAIG;AAEH;IAAyC,+BAAY;IADrD;QAAA,qEAqEC;QAlEG,WAAK,GAAc,IAAI,CAAC;QAGxB,UAAI,GAAY,IAAI,CAAC;QAGrB,eAAS,GAAgB,IAAI,CAAC;QAG9B,gBAAU,GAAY,IAAI,CAAC;QAG3B,eAAS,GAAY,IAAI,CAAC;QAE1B,WAAK,GAAmB,IAAI,CAAC;;IAoDjC,CAAC;IAlDG,4BAAM,GAAN;QACI,IAAI,CAAC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;IACnD,CAAC;IAED;;OAEG;IACI,8BAAQ,GAAf;QACI,IAAI,IAAI,CAAC,KAAK,KAAK,IAAI,EAAE;YACrB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAC,IAAI;gBAC1C,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAC,OAAO;oBAC7B,IAAM,GAAG,GAAG,OAAO,CAAC,YAAY,CAAC,oBAAU,CAAC,CAAC;oBAC7C,GAAG,CAAC,KAAK,EAAE,CAAC;oBACZ,OAAO,GAAG,CAAC;gBACf,CAAC,CAAC,CAAC;YACP,CAAC,CAAC,CAAC;SACN;QAED,OAAO,IAAI,CAAC,KAAK,CAAC;IACtB,CAAC;IAED;;OAEG;IACI,2BAAK,GAAZ;QACI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;YACpB,IAAI,CAAC,OAAO,CAAC,UAAC,GAAG;gBACb,GAAG,CAAC,KAAK,EAAE,CAAC;YAChB,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACI,0BAAI,GAAX;QAAA,iBAOC;QANG,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO;YACvB,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,CAAC;YAC3D,KAAI,CAAC,UAAU,CAAC,OAAO,GAAG,CAAC,CAAC;YAC5B,KAAI,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;YAC9B,KAAI,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,aAAa,EAAE,GAAG,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QAChG,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACI,mCAAa,GAApB;QACI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IACjC,CAAC;IAjED;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;8CACI;IAGxB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;6CACG;IAGrB;QADC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC;kDACQ;IAG9B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;mDACS;IAG3B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;kDACQ;IAdT,WAAW;QAD/B,OAAO;OACa,WAAW,CAoE/B;IAAD,kBAAC;CApED,AAoEC,CApEwC,EAAE,CAAC,SAAS,GAoEpD;kBApEoB,WAAW","file":"","sourceRoot":"/","sourcesContent":["import WritingDot from './WritingDot';\n\nconst { ccclass, property } = cc._decorator;\n\nconst FILL_DURATION = 0.5;\n\n/**\n * 书写字符\n * \n * 注：配置字符时，每个线条的最后一点，必须是引导节点\n */\n@ccclass\nexport default class WritingChar extends cc.Component {\n    @property(cc.Sprite)\n    image: cc.Sprite = null;\n\n    @property(cc.Mask)\n    mask: cc.Mask = null;\n\n    @property(cc.Graphics)\n    drawPanel: cc.Graphics = null;\n\n    @property(cc.Node)\n    filledChar: cc.Node = null;\n\n    @property(cc.Node)\n    linesNode: cc.Node = null;\n\n    lines: WritingDot[][] = null;\n\n    onLoad() {\n        this.mask.spriteFrame = this.image.spriteFrame;\n    }\n\n    /**\n     * 获取该字符所有笔画\n     */\n    public getLines() {\n        if (this.lines === null) {\n            this.lines = this.linesNode.children.map((line) => {\n                return line.children.map((dotNode) => {\n                    const dot = dotNode.getComponent(WritingDot);\n                    dot.reset();\n                    return dot;\n                });\n            });\n        }\n\n        return this.lines;\n    }\n\n    /**\n     * 重置所有点状态\n     */\n    public reset() {\n        this.lines.forEach((line) => {\n            line.forEach((dot) => {\n                dot.reset();\n            });\n        });\n    }\n\n    /**\n     * 填充，渐显下面的图层，渐隐上面的画布\n     */\n    public fill() {\n        return new Promise((resolve) => {\n            this.drawPanel.node.runAction(cc.fadeTo(FILL_DURATION, 0));\n            this.filledChar.opacity = 0;\n            this.filledChar.active = true;\n            this.filledChar.runAction(cc.sequence(cc.fadeTo(FILL_DURATION, 255), cc.callFunc(resolve)));\n        });\n    }\n\n    /**\n     * 显示画板\n     */\n    public showDrawPanel() {\n        this.mask.node.active = true;\n    }\n}\n"]}